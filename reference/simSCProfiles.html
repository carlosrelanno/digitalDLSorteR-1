<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate new single-cell expression profiles using ZINB-WaVE model parameters — simSCProfiles • digitalDLSorteR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Simulate new single-cell expression profiles using ZINB-WaVE model parameters — simSCProfiles" />
<meta property="og:description" content="Simulate single-cell expression profiles by randomly sampling from a negative
binomial distribution and inserting dropouts by sampling from a binomial
distribution using ZINB -WaVE parameters estimated by
estimateZinbwaveParams function." />
<meta property="og:image" content="/logo.png" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">digitalDLSorteR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href=".././articles/pretrainedModels.html">Using pre-trained context-specific deconvolution models</a>
    </li>
    <li>
      <a href=".././articles/newModels.html">Building new deconvolution models</a>
    </li>
    <li>
      <a href=".././articles/realModelExample.html">Performance of a real model: deconvolution of colorectal cancer samples</a>
    </li>
    <li>
      <a href=".././articles/kerasIssues.html">Keras/TensorFlow installation and configuration</a>
    </li>
    <li>
      <a href=".././articles/hdf5Backend.html">HDF5 files as back-end</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/diegommcc/digitalDLSorteR">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate new single-cell expression profiles using ZINB-WaVE model parameters</h1>
    <small class="dont-index">Source: <a href='https://github.com/diegommcc/digitalDLSorteR/R/simSingleCell.R'><code>R/simSingleCell.R</code></a></small>
    <div class="hidden name"><code>simSCProfiles.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate single-cell expression profiles by randomly sampling from a negative
binomial distribution and inserting dropouts by sampling from a binomial
distribution using ZINB -WaVE parameters estimated by
<code><a href='estimateZinbwaveParams.html'>estimateZinbwaveParams</a></code> function.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>simSCProfiles</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>cell.ID.column</span>,
  <span class='va'>cell.type.column</span>,
  <span class='va'>n.cells</span>,
  suffix.names <span class='op'>=</span> <span class='st'>"_Simul"</span>,
  cell.types <span class='op'>=</span> <span class='cn'>NULL</span>,
  file.backend <span class='op'>=</span> <span class='cn'>NULL</span>,
  name.dataset.backend <span class='op'>=</span> <span class='cn'>NULL</span>,
  compression.level <span class='op'>=</span> <span class='cn'>NULL</span>,
  block.processing <span class='op'>=</span> <span class='cn'>FALSE</span>,
  block.size <span class='op'>=</span> <span class='fl'>1000</span>,
  chunk.dims <span class='op'>=</span> <span class='cn'>NULL</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p><code><a href='DigitalDLSorter-class.html'>DigitalDLSorter</a></code> object with
<code>single.cell.real</code> and <code>zinb.params</code> slots.</p></td>
    </tr>
    <tr>
      <th>cell.ID.column</th>
      <td><p>Name or column number corresponding to cell names of
expression matrix in cells metadata.</p></td>
    </tr>
    <tr>
      <th>cell.type.column</th>
      <td><p>Name or column number corresponding to the cell type
of each cell in cells metadata.</p></td>
    </tr>
    <tr>
      <th>n.cells</th>
      <td><p>Number of simulated cells generated by cell type (i.e. if you
have 10 different cell types in your dataset, if <code>n.cells = 100</code>, then
1000 cell profiles will be simulated).</p></td>
    </tr>
    <tr>
      <th>suffix.names</th>
      <td><p>Suffix used in simulated cells. This suffix must be
unique in simulated cells, so ensure that this suffix does not appear in
real cell names.</p></td>
    </tr>
    <tr>
      <th>cell.types</th>
      <td><p>Vector indicating which cell types you want to simulate. If
<code>NULL</code> (by default), <code>n.cells</code> single-cell profiles for all cell
types will be simulated.</p></td>
    </tr>
    <tr>
      <th>file.backend</th>
      <td><p>Valid file path to store simulated single-cell expression
profiles as HDF5 file (<code>NULL</code> by default). If provided, data is stored
in HDF5 files as back-end by using <span class="pkg">DelayedArray</span>, <span class="pkg">HDF5Array</span> and
<span class="pkg">rhdf5</span> packages instead of loading in RAM memory. This is suitable for
situations where you have a large amount of data that cannot be allocated
in memory. Note that operations on this data will be carried out by blocks
(i.e subsets of determined size) which can lead to longer execution times.</p></td>
    </tr>
    <tr>
      <th>name.dataset.backend</th>
      <td><p>Name of dataset in HDF5 file that will be used.
Note that it cannot exist. If <code>NULL</code> (by default), a random dataset
name will be used.</p></td>
    </tr>
    <tr>
      <th>compression.level</th>
      <td><p>The compression level used if <code>file.backend</code> is
provided. It is an integer value between 0 (no compression) and 9 (highest
and slowest compression). See
<code>?<a href='https://rdrr.io/pkg/HDF5Array/man/dump-management.html'>getHDF5DumpCompressionLevel</a></code> from <span class="pkg">HDF5Array</span>
package for more information.</p></td>
    </tr>
    <tr>
      <th>block.processing</th>
      <td><p>Boolean indicating if data should be simulated by
blocks (only if <code>file.backend</code> is used, <code>FALSE</code> by default). This
functionality is suitable for cases where is not possible to allocate data
in memory and it leads to longer execution times.</p></td>
    </tr>
    <tr>
      <th>block.size</th>
      <td><p>Number of single-cell expression profiles that will be
simulated in each iteration during the process. Higher numbers resulting in
more memory usage but lesser execution times. Set according to available
computational resources (1000 by default). Note that it cannot be greater
than the total number of simulated cells.</p></td>
    </tr>
    <tr>
      <th>chunk.dims</th>
      <td><p>Specifies the dimensions that HDF5 chunk will have. If
<code>NULL</code>, the default value is a vector of two items: the number of
genes considered by ZINB-WaVE model during the simulation and only one
sample in order to increase the read times in the following steps. Greater
number of columns written in each chunk can lead to longer read times in
subsequent steps. Note that it cannot be  greater than dimensions of
simulated matrix.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Show informative messages during the execution (<code>TRUE</code> by
default).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='DigitalDLSorter-class.html'>DigitalDLSorter</a></code> object with
<code>single.cell.simul</code> slot containing a
<code>SingleCellExperiment</code> object with the simulated
single-cell expression profiles.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Before this step, see <code>?<a href='estimateZinbwaveParams.html'>estimateZinbwaveParams</a></code>. As described in
Torroja and Sanchez-Cabo, 2019, this function simulates a determined number
of transcriptional profiles for each cell type provided by randomly sampling
from a negative binomial distribution with \(\mu\) and \(\theta\)
estimated parameters and inserting dropouts by sampling from a binomial
distribution with pi probability. All parameters are estimated from
single-cell real data using <code><a href='estimateZinbwaveParams.html'>estimateZinbwaveParams</a></code> function. It
uses the ZINB-WaVE model (Risso et al., 2018). For more details about the
model, see <code>?<a href='estimateZinbwaveParams.html'>estimateZinbwaveParams</a></code> and Risso et al., 2018.</p>
<p><code>file.backend</code> argument allows to create a HDF5 file with simulated
single-cell profiles that will be used as back-end in order to work with data
allocated on disk instead of RAM memory. If you use <code>file.backend</code>
argument with <code>block.processing = FALSE</code>, all single-cell profiles will
be simulated in one step and, therefore, allocated in RAM memory. Then, data
will be written in HDF5 file. In order to avoid collapsing RAM memory if so
many single-cell profiles are simulated, single-cell profiles can be
simulated and written in HDF5 files by blocks of <code>block.size</code> size by
setting <code>block.processing = TRUE</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Risso, D., Perraudeau, F., Gribkova, S. et al. (2018). A general
and flexible method for signal extraction from single-cell RNA-seq data.
Nat Commun 9, 284. doi:
<a href='https://doi.org/10.1038/s41467-017-02554-5'>10.1038/s41467-017-02554-5</a>
Torroja, C. and Sánchez-Cabo, F. (2019). digitalDLSorter: A Deep Learning
algorithm to quantify immune cell populations based on scRNA-Seq data.
Frontiers in Genetics 10, 978. doi:
<a href='https://doi.org/10.3389/fgene.2019.00978'>10.3389/fgene.2019.00978</a></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='estimateZinbwaveParams.html'>estimateZinbwaveParams</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ns-load.html'>requireNamespace</a></span><span class='op'>(</span><span class='st'>"digitalDLSorteRdata"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/diegommcc/digitalDLSorteRdata.git'>digitalDLSorteRdata</a></span><span class='op'>)</span></span>
<span class='r-in'>  <span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>DDLSChung</span><span class='op'>)</span></span>
<span class='r-in'>  <span class='va'>DDLSChung</span> <span class='op'>&lt;-</span> <span class='fu'>simSCProfiles</span><span class='op'>(</span></span>
<span class='r-in'>    object <span class='op'>=</span> <span class='va'>DDLSChung</span>,</span>
<span class='r-in'>    cell.ID.column <span class='op'>=</span> <span class='st'>"Cell_ID"</span>,</span>
<span class='r-in'>    cell.type.column <span class='op'>=</span> <span class='st'>"Cell_type"</span>,</span>
<span class='r-in'>    n.cells <span class='op'>=</span> <span class='fl'>10</span>,</span>
<span class='r-in'>    verbose <span class='op'>=</span> <span class='cn'>TRUE</span></span>
<span class='r-in'>  <span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> === Get parameters from model:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - mu: 22, 18751</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - pi: 22, 18751</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - Theta: 18751</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> === Selected cell type(s) from ZINB-WaVE model (13 cell type(s)):</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - Bmem</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - DC</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - ER+</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - ER+ and HER2+</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - HER2+</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - Macrophage</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - Monocyte</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - Stromal</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - TCD8</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - Tme</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - TNBC</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - Treg</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - BGC</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> === Simulated matrix dimensions:</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - n (cells): 130</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - J (genes): 18751</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span>     - i (# entries): 2437630</span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> DONE</span>
<span class='r-in'></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by <a href="https://github.com/diegommcc" class="external-link">Diego Mañanes</a>, <a href="https://www.cnic.es/en/carlos-torroja" class="external-link">Carlos Torroja</a>, <a href="https://www.cnic.es/en/fatima-sanchez-cabo" class="external-link">Fatima Sanchez-Cabo</a>.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


